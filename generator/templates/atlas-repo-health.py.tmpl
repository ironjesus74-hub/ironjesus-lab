#!/usr/bin/env python3
# __TITLE__ | __DESC__
from pathlib import Path

ROOT = Path.cwd()
REQ = ["README.md"]
OPT = ["LICENSE", "SECURITY.md", ".gitignore"]
MAX_MB = 10

def main():
  miss_req = [f for f in REQ if not (ROOT/f).exists()]
  miss_opt = [f for f in OPT if not (ROOT/f).exists()]
  big = []
  for p in ROOT.rglob("*"):
    if p.is_file():
      try: sz = p.stat().st_size
      except OSError: continue
      if sz > MAX_MB*1024*1024: big.append((p,sz))
  print("required_missing=" + (",".join(miss_req) if miss_req else "none"))
  print("optional_missing=" + (",".join(miss_opt) if miss_opt else "none"))
  if big:
    print("big_files=")
    for p,sz in sorted(big,key=lambda x:x[1],reverse=True)[:20]:
      print(f"  - {p.relative_to(ROOT)} ({sz/1024/1024:.2f}MB)")
  else:
    print("big_files=none")

if __name__ == "__main__":
  main()
